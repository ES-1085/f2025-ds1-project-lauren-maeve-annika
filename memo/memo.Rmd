---
title: "Project memo"
author: "Lauren, Maeve, Annika"
output: github_document
---

This document should contain a detailed account of the data clean up for your data and the design choices you are making for your plots. For instance you will want to document choices you've made that were intentional for your graphic, e.g. color you've chosen for the plot. Think of this document as a code script someone can follow to reproduce the data cleaning steps and graphics in your handout.

```{r load-packages, message = FALSE}
library(tidyverse)
library(broom)
```

## Data Clean Up Steps for Overall Data

### Step 1: Remove Referee Category

For our dataset, there were no names listed in the Referee variable and it was irrelevant for our project.

```{r remove-referee}
#season$Referee <- NULL
```

### Step 2: _______



## Plots

### Plot 1: Bar Chart

#### Data cleanup steps specific to plot 1

We chose these colors since they were different enough that someone can glance at the graph and see the difference with the low opacity. We wanted overlap so that each team can compare their home and away game shots taken easily.

```{r bar-average-shots ggsave}
team_order <- season |>
  group_by(HomeTeam) |>
  summarise(mean_HS = mean(HS, na.rm = TRUE)) |>
  arrange(desc(mean_HS)) |>
  pull(HomeTeam)

summary_long <- season |>
  group_by(HomeTeam) |>
  summarise(mean_HS = mean(HS, na.rm = TRUE),
            mean_AS = mean(AS, na.rm = TRUE)) |>
  pivot_longer(cols = c(mean_HS, mean_AS),
               names_to = "ShotType",
               values_to = "Shots")

ggplot(summary_long, aes(x = factor(HomeTeam, levels = team_order),
                         y = Shots,
                         fill = ShotType)) +
  geom_col(position = "identity", alpha = 0.7) +
  scale_fill_manual(
    values = c("mean_HS" = "goldenrod1", "mean_AS" = "palevioletred1"),
    labels = c("mean_HS" = "Average Home Shots", "mean_AS" = "Average Away Shots")
  ) +
  labs(title = "Average Home vs Away Shots per Team",
       x = "Team",
       y = "Average Shots",
       fill = "Shot Type") +
  coord_flip() +
  ylim(0, 25)

#ggsave("our_newplot.png")
```

After feedback from class, we changed the graph type to a multi bar chart so the overlap is removed and it allows for clear understanding of the graph and readability to be easier. We also changed the graph to be more color blind friendly so accessibility is also higher.

#### Final Plot 1

```{r multi-bar-average-shots ggsave}
team_order <- season |>
  group_by(HomeTeam) |>
  summarise(mean_HS = mean(HS, na.rm = TRUE)) |>
  arrange(desc(mean_HS)) |>
  pull(HomeTeam)

summary_long <- season |>
  group_by(HomeTeam) |>
  summarise(mean_HS = mean(HS, na.rm = TRUE),
            mean_AS = mean(AS, na.rm = TRUE)) |>
  pivot_longer(cols = c(mean_HS, mean_AS),
               names_to = "ShotType",
               values_to = "Shots")

ggplot(summary_long, aes(x = factor(HomeTeam, levels = team_order),
                         y = Shots,
                         fill = ShotType)) +
  geom_col(position = "dodge", alpha = 0.8) +
  scale_fill_manual(
    values = c("mean_HS" = "palevioletred1", "mean_AS" = "cornflowerblue"),
    labels = c("mean_HS" = "Average Home Shots", "mean_AS" = "Average Away Shots")
  ) +
  labs(title = "Average Home vs Away Shots per Team",
       x = "Team",
       y = "Average Shots",
       fill = "Shot Type") +
  coord_flip() +
  ylim(0, 25)

#ggsave("our_newplot.png")
```

### Plot 2: Box Plot

#### Data cleanup steps specific to plot 2

```{r away-vs-home-boxplot}
shots_data <- data.frame(
  ShotsOnTarget = c(season$HST, season$AST),
  Team = c(rep("Home", nrow(season)), rep("Away", nrow(season)))
)
ggplot(shots_data, aes(x = Team, y = ShotsOnTarget, fill = Team)) +
  geom_boxplot(alpha = 0.8) +
  labs(
    title = "Home vs Away Shots on Target",
    x = "Team",
    y = "Shots on Target per Match",
    fill = "Team"
  ) +
  scale_fill_manual(values = c("Home" = "goldenrod1", "Away" = "palevioletred1"))
#ggsave("our_newboxplot.png")
```

Following advice from first plot critique, we changed colors to be more colorblind friendly.

```{r away-vs-home-boxplot}
shots_data <- data.frame(
  ShotsOnTarget = c(season$HST, season$AST),
  Team = c(rep("Home", nrow(season)), rep("Away", nrow(season)))
)
ggplot(shots_data, aes(x = Team, y = ShotsOnTarget, fill = Team)) +
  geom_boxplot(alpha = 0.8) +
  labs(
    title = "Home vs Away Shots on Target",
    x = "Team",
    y = "Shots on Target per Match",
    fill = "Team"
  ) +
  scale_fill_manual(values = c("Home" = "palevioletred1", "Away" = "cornflowerblue"))
#ggsave("our_newboxplot.png")
```